import psycopg2
class Prep:
    def __init__(self,table,user,password,host,port,database) :
        self.connection = psycopg2.connect(user=user, password= password, host=host, port=port, database=database)
        self.table = table
        self.primary_key = ''
        self.user = user
        self.password = password
        self.host = host
        self.port = port
        self.database = database
       
   

    def create_table(self, values={'name': 'varchar(50)', 'address': 'varchar(50)', 'phone': 'int'}, pk=''):
        try:  
            self.primary_key = pk
            values[self.primary_key] = values[self.primary_key] + ' PRIMARY KEY'
            cursor=self.connection.cursor()
            res = []
            for i, j in values.items():
                res.append(str(i)+' '+str(j))
            query = f"""create table {self.table} ({', '.join(res)})"""
            print(query)
   
            cursor.execute(query)
            self.connection.commit()
            print("table created successfully")
        except Exception as e:
            print("Error creating table:", e)  



Prepobj=Prep('table91', user='postgres',password='1234', host= 'localhost' , port = 5432, database ='northwind')

Prepobj.create_table(pk='phone')
